# TPM caculate

yukaiquan **1962568272@qq.com**

## input gff

```
arahy.Tifrunner.gnm1.Arahy.01	maker	gene	20298	26071	.	+	.	ID=arahy.Tifrunner.gnm1.ann1.GHMM2H;Name=GHMM2H;Dbxref=Gene3D:G3DSA:3.40.50.1000,Gene3D:G3DSA:3.40.50.10190,InterPro:IPR001357,InterPro:IPR004274,InterPro:IPR011947,InterPro:IPR023214,JCVI_TIGRFAMS:TIGR02250,PANTHER:PTHR23081,Pfam:PF00533,Pfam:PF03031,Prosite:PS50172,Prosite:PS50969,SMART:SM00292,SMART:SM00577,Superfamily:SSF52113,Superfamily:SSF56784;Ontology_term=GO:0004721,GO:0005515,GO:0005634;Note=C-terminal domain phosphatase-like 4%3B IPR001357 (BRCT domain)%2C IPR004274 (NLI interacting factor)%2C IPR023214 (HAD-like domain)%3B GO:0004721 (phosphoprotein phosphatase activity)%2C GO:0005515 (protein binding)%2C GO:0005634 (nucleus)
arahy.Tifrunner.gnm1.Arahy.01	maker	mRNA	20298	26071	.	+	.	ID=arahy.Tifrunner.gnm1.ann1.GHMM2H.1;Parent=arahy.Tifrunner.gnm1.ann1.GHMM2H;Name=GHMM2H.1;_AED=0.32;_eAED=0.32;_QI=0|0.57|0.62|0.87|0.71|0.62|8|540|477
arahy.Tifrunner.gnm1.Arahy.01	maker	mRNA	20298	26071	.	+	.	ID=arahy.Tifrunner.gnm1.ann1.GHMM2H.2;Parent=arahy.Tifrunner.gnm1.ann1.GHMM2H;Name=GHMM2H.2;_AED=0.33;_eAED=0.33;_QI=0|0.71|0.87|0.87|0.85|0.87|8|540|425
arahy.Tifrunner.gnm1.Arahy.01	maker	exon	20298	20300	.	+	.	ID=arahy.Tifrunner.gnm1.ann1.GHMM2H.1:exon:163;Parent=arahy.Tifrunner.gnm1.ann1.GHMM2H.1,arahy.Tifrunner.gnm1.ann1.GHMM2H.2
arahy.Tifrunner.gnm1.Arahy.01	maker	CDS	20298	20300	.	+	0	ID=arahy.Tifrunner.gnm1.ann1.GHMM2H.1:cds;Parent=arahy.Tifrunner.gnm1.ann1.GHMM2H.1
arahy.Tifrunner.gnm1.Arahy.01	maker	CDS	20298	20300	.	+	0	ID=arahy.Tifrunner.gnm1.ann1.GHMM2H.2:cds;Parent=arahy.Tifrunner.gnm1.ann1.GHMM2H.2
```

## input count matrix

```
GeneName ,leaf1.1,leaf1.2,leaf1.3,leaf2.1,leaf2.2,leaf2.3,leaf3.1,leaf3.2,leaf3.3,veg shoot.1,veg shoot.2,veg shoot.3,repr shoot.1,repr shoot.2,repr shoot.3,root.1,root.2,root.3,nodule.1,nodule.2,nodule.3,perianth.1,perianth.2,perianth.3,stamen.1,stamen.2,pistil.1,pistil.2,pistil.3,peg tip 1.1,peg tip 1.2,peg tip 1.3,peg tip 2.1,peg tip 2.2,peg tip 2.3,peg tip Pat. 1.2,fruit Pat. 1.1,fruit Pat. 3.1,fruit Pat. 3.3,pericarp Pat. 5.1,pericarp Pat. 5.2,pericarp Pat. 5.3,pericarp Pat. 6.1,pericarp Pat. 6.2,pericarp Pat. 6.3,seed Pat. 5.1,seed Pat. 5.2,seed Pat. 6.1,seed Pat. 6.2,seed Pat. 7.1,seed Pat. 7.2,seed Pat. 8.1,seed Pat. 10.1,seed Pat. 10.2
0002EG,0,1,1,2,0,0,0,0,2,0,1,0,0,0,2,0,2,2,0,2,2,2923,2853,2406,8,0,134,0,169,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0003EL,415,321,60,209,208,239,59,56,67,67,52,108,168,146,248,99,732,1229,1448,768,674,615,669,540,684,58,1031,330,1106,1160,634,610,421,279,451,944,415,437,1065,424,1435,1013,314,822,1952,362,638,824,897,884,729,453,113,343
0008XH,37,119,67,15,52,328,44,26,25,3,12,14,28,42,39,5,49,66,0,15,5,22,27,3,16,8,194,14,46,36,14,4,0,6,2,24,10,0,8,6,14,6,0,8,2,8,11,15,14,5,2,1,0,0
002YPW,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,21,2,1,0,25,27,6,9,10,19,4,72,1,0,0,2,0,0,2,0,1,0,0,0,0,0,2,2,0,25
0034KJ,388,684,88,463,179,387,84,77,29,26,33,96,305,1369,1501,265,2021,3113,1334,659,492,3402,4200,1360,923,108,24377,372,13952,640,538,281,122,126,94,3818,87,218,216,119,243,386,131,387,724,283,1046,301,795,239,333,94,35,148
0046K4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
```

## caculate

```python
python count_2_tpm.py arahy.Tifrunner.gnm1.ann1.CCJH.gene_models_main.gff3 Arahy_all_tissue_htseq_count.csv Arahy_all_tissue_htseq_TPM.csv
```

## output file

```
GeneName ,leaf1.1,leaf1.2,leaf1.3,leaf2.1,leaf2.2,leaf2.3,leaf3.1,leaf3.2,leaf3.3,veg shoot.1,veg shoot.2,veg shoot.3,repr shoot.1,repr shoot.2,repr shoot.3,root.1,root.2,root.3,nodule.1,nodule.2,nodule.3,perianth.1,perianth.2,perianth.3,stamen.1,stamen.2,pistil.1,pistil.2,pistil.3,peg tip 1.1,peg tip 1.2,peg tip 1.3,peg tip 2.1,peg tip 2.2,peg tip 2.3,peg tip Pat. 1.2,fruit Pat. 1.1,fruit Pat. 3.1,fruit Pat. 3.3,pericarp Pat. 5.1,pericarp Pat. 5.2,pericarp Pat. 5.3,pericarp Pat. 6.1,pericarp Pat. 6.2,pericarp Pat. 6.3,seed Pat. 5.1,seed Pat. 5.2,seed Pat. 6.1,seed Pat. 6.2,seed Pat. 7.1,seed Pat. 7.2,seed Pat. 8.1,seed Pat. 10.1,seed Pat. 10.2
0002EG,0.0,0.07868575923676097,0.32222839703181655,0.3263424523852437,0.0,0.0,0.0,0.0,0.7418939923733151,0.0,0.5730497520636663,0.0,0.0,0.0,0.6393919492485284,0.0,0.17581810524789943,0.13933105474496893,0.0,0.19195257797672685,0.22829585353177184,717.5709389907429,776.3579930492186,1229.5064223949746,1.043732115465937,0.0,5.139359855426502,0.0,15.42169126078305,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
0003EL,13.398896198023344,7.041527013938336,5.38990038722089,9.507263721327917,7.725100952480745,4.708422438435359,5.632643437113443,4.617614544835491,6.92870927607708,13.505135200674736,8.30732784922069,10.479563741231518,12.00736604338413,9.94608577667923,22.103168093222344,13.484099500864685,17.939500993518628,23.869069534726222,49.12337768607126,20.549007526735682,21.448335883869913,42.08979591243831,50.75187041874661,76.92980225910138,24.878307944931688,15.643366214018778,11.02373012010953,17.934592592793265,28.13624288827884,19.89662472506475,11.728943698752184,21.454427507856263,18.708126715751657,17.679904173952494,20.26710298965188,17.25210807737381,18.679977194988084,15.680229208066217,30.944305117249844,14.359083240143361,32.719837827482074,20.041276836402805,17.682569527596577,25.53524730332594,33.4432232240682,18.948316436239377,21.607224458944344,20.160972044941435,25.3388003242111,27.022292736987232,19.713007180462633,23.648904193113843,16.074997024269937,14.516843536523863
0008XH,1.4385240225216507,3.1434260470632065,7.2476758260972,0.8216653683354118,2.3256193966892296,7.781186636192763,5.058332734367561,2.5816506150071272,3.113235784749801,0.728181862035287,2.3085204252767926,1.6358442528003436,2.409855314117234,3.44542740452992,4.1856404702796075,0.8200705709447559,1.4460716976865715,1.5435546523464105,0.0,0.4832984018272667,0.1916011796918483,1.813087875681589,2.4665173095768194,0.5146554543220859,0.7007759501955588,2.598284332351918,2.4978485685086262,0.9162206591907713,1.4091696399363305,0.7435640581491971,0.311883319652353,0.1694109802354112,0.0,0.45784810673974824,0.10822799102912509,0.5281726228320138,0.5420292379798473,0.0,0.2799081749907318,0.24468456573394542,0.3843985544794217,0.1429425946167667,0.0,0.29926278033477105,0.04126223790627245,0.5042507049648615,0.4486063933523379,0.441946789731154,0.4762292986158617,0.18404939854265073,0.06512531189546614,0.06286476387106531,0.0,0.0
002YPW,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,8.96072534613549,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,10.050101316627527,7.097716068066596,0.14068775996872646,0.0,8.368302943358843,6.0935670097181065,1.4605193050081584,4.165009654243019,5.847020476231922,15.842208041176072,2.3651654790117727,17.313667785053998,0.592263068959673,0.0,0.0,0.8912042726007549,0.0,0.0,1.481945149815335,0.0,0.22543156293186614,0.0,0.0,0.0,0.0,0.0,0.7116095292925649,1.3738180662898714,0.0,13.92209177585916
```

